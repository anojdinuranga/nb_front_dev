<!DOCTYPE html>
<html lang="en">

<head>
    <title>Queen Kuweni - Login</title>
    <%- header_tags %>
        <style>
            html,
            body {
                overflow-x: hidden !important;
            }
        </style>
</head>

<body>

    <!------------------- navbar start--------------->
    <%- sidebar %>
        <!----------------- navbar end--------------->


        <!------------------ Login form ------------------>
        <div class="Login-form-height-mq d-flex align-items-center justify-content-center pb-5">

            <section class="Login-form-height main-padding-top col-12 mt-5 mt-md-0 px-4 d-flex align-items-center ">
                <div class="h-100 w-100 row d-flex justify-content-center">
                    <div class="col col-md-6 col-xl-3 login-form-mq d-flex justify-content-center">
                        <div class="d-flex w-100 flex-column justify-content-center ">
                            <div class="d-flex justify-content-center">
                                <h6 class="Login-Or-register-text mb-3">Set new password</h6>
                            </div>
                            <div class="text-center w-100 loginemail" id="">
                                <div class="mb-2">
                                    <input class="" type="password" id="password1" placeholder="New Password" />
                                </div>

                                <div class="mb-2">
                                    <input class="" type="password" id="password2" placeholder="Confirm Password" />
                                </div>
                                <!-- <p class="login-form-laber text-start">Please enter your email.</p> -->

                                <div class="text-end mt-2">
                                    <a href="/login" class="register-form-link">Remember password?
                                        Login</a>
                                </div>

                                <div class="mb-3 d-flex justify-content-center">
                                    <button class="btn btn-dark text-white d-block mt-4 login-button"
                                        onclick="resetPassword()" type="submit">Confirm</button>
                                </div>
                            </div>


                            <div class="d-none border-top mt-5">
                                <div class="d-flex justify-content-center w-100 mt-5">
                                    <button type="button" class="btn login-button2 w-50 me-3">
                                        <img src="assets/images/Login/Group.svg" class="img-fluid" alt="">
                                    </button>

                                    <button type="button" class="btn login-button2 w-50">
                                        <img src="assets/images/Login/Vector.svg" class="img-fluid" alt="">
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        <!------------------ Login form End------------------>

        <!-- Footer Start-->
        <%- web_footer %>
            <!-- Footer End-->

            <!-- script start-->
            <script>

                function resetPassword() {
                    if ($('#password1').val() !== $('#password2').val()) {
                        iziToast.error({
                            theme: 'dark',
                            title: 'Error',
                            message: "New password and confirmation password do not match",
                        });
                        return;
                    }
                    $.ajax({
                        url: '/api/v1/user/update-password',
                        method: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            "id": '<%= id %>',
                            "tempKey": '<%= key %>',
                            "password": $('#password1').val()
                        }),
                        success: function (data) {
                            if (data.status === true || data.status === "true") {

                                iziToast.success({
                                    theme: 'dark',
                                    title: 'Success',
                                    message: data.message,
                                });

                                window.location = "/login";

                            } else {

                                iziToast.error({
                                    theme: 'dark',
                                    title: 'Error',
                                    message: data.message,
                                });
                            }
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            console.error('Error making the request:', textStatus, errorThrown);
                            iziToast.error({
                                theme: 'dark',
                                title: 'Error',
                                message: 'An error occurred while processing your request.',
                            });
                        }
                    });
                }
            </script>
            <%- script_tags %>
                <!-- script start-->
</body>

</html>